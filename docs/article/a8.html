<!doctype html>
<html><head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src='https://www.googletagmanager.com/gtag/js?id=UA-131319832-1'></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131319832-1');
</script><link rel='shortcut icon' href='../favicon.ico'>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
<title>自作で静的ブログを作る</title>
<link rel='stylesheet' type='text/css' href='../css/common.css'>
</head><body>
<div class='breadcrumbs'>
<ul>
<li><a href='../'>トップ</a></li>
<li><a href='../ctg2.html'>郵便・統計・Web</a></li><li>自作で静的ブログを作る</li></ul></div><div class='title'><h2 class='article'>自作で静的ブログを作る</h2></div> <div class='keyarea'><a class='keyword'>　Web　</a><a>　</a><a class='keyword'>　R　</a><a>　</a></div> 
<div class='go2attention'><a href='#attention'>注意事項はこちら</a></div>
<div class='article'>
<h3 id='mot'>動機</h3>
<p>
平成最後の12月に、ブログを始めてみようと思い立ち、「GitHub PagesでHPを公開する試み」という名前でHPを作成しました。主に、HTMLやWebの勉強がしたいと思ったことと、文章力を鍛えること、そして、後々のための忘備録的なものになればいいなと思っています。ブログと言ったりHPと言ったりしていますが、個人的にはその中間みたいな存在を目指しているところです。
</p><p>
さて、タイトルにもありますが、今このページは、GitHub Pagesというサービスを使って公開しています。GitHub Pagesというのは何かわからない読者の方も多いかもしれません。せっかくですから、このブログみたいなHPをどのように管理・公開しているのかをご紹介したいと思います。
</p><p>
ちなみに、ブログをあえて自作する必要はないです。無料のサービスもたくさんあります。これは、私の勉強用の要素が強いですから、ブログを始めようとしている人には参考にならないと思います。（こんなこというと、この記事のターゲットは誰だよって感じになりますがね……。）
<p></p>
私の能力： HTMLやCSSはコピペでなんとか用意できる。Javascriptは赤ちゃんレベル。Rは頼みの綱。SQL？PHP？なにそれおいしいの？
</p>

<h3 id='system'>ブログとその仕組み</h3>
<p>
Wikipediaによると、
<blockquote>
ブログ (blog) は、World Wide Web上のウェブページに、覚え書きや論評などを記すウェブサイトである。
―<a href=' https://ja.wikipedia.org/wiki/%E3%83%96%E3%83%AD%E3%82%B0' target='_blank'>
Wikipedia</a>
</blockquote>
とあります。
これに従えば、この「GitHub PagesでHPを公開する試み」もブログになりますね。
</p>
<p>
ブログ、というよりもブログも含めたWebページを公開するには、サーバーとHTMLファイルが最低限必要です。
<ul><li>
サーバーとは、常にインターネットにつながっている特別なパソコンです。
</li><li>
HTMLは、Webページを作成するための言語です。</li></ul>
ここでは、HPを立ち上げる方法、つまり、サーバーとHTMLを用意する方法について、私の選択理由も含めてご説明いたします。
</p>

<h3 id='html'>HTMLの作成方法</h3>
<h4>たとえば、Word Press</h4>
<p> 
ブログといえば、最近だとWord Pressなんていうフリーソフトが人気なようです。
また、<a href=' https://hatenablog.com/guide' target='_blank'>はてなブログ</a>などのブログサービスもありますが、Word Pressは、カスタマイズ性やユーザーの多さによるドキュメント（解説など）の豊富さで、どんどんユーザーが増えているようです。
</p><p>
<a href='https://ja.wordpress.org/' target='_blank'>Word Pressの公式サイト</a>によると、Web 上の32%のサイトが WordPress を使っているようです（2019年1月1日確認）。
</p><p>
このソフトウェアは、普通のパソコンの中ではなく、サーバーの中で動きます。
</p><p>
Word Pressは、サーバーの上で、PHPやSQLといった言語を駆使して、読者が「この記事が見たい」とリクエストを送ると、データベースという、情報の集合体からWebページ（HTMLファイル）を作成して、読者へ返すソフトウェアです。こうして、ブログにアクセスがあるたびに、ソフトウェアがサーバー上で動いて、「動的」に、その都度HTMLファイルを作って送り返しているわけです。このようなWebページを動的サイトと言います。
</p><p>
この仕組みのおかげで、ブログ執筆者は、いちいちHTMLファイルを作ってアップロードする必要はありません。リアルタイムに情報を反映したり、コメント機能も付けられます（コメントを受け取ってデータベースに入れ、次回からそれを取り出してHTMLに反映させることができるのだと思います）。
</p><p>
上記の説明は、以下のHPにわかりやすくまとめられています。
</p><p class='ref'>

<a href='https://saruwakakun.com/html-css/wordpress/whatis-wp' target='_blank'>WordPressとは？初心者でも分かるように仕組みを図解</a><br>
―サルワカ
</p><p> 
一方で、デメリットとして、セキュリティに気を使わねばならないという問題が挙げられます。Word Pressは、サーバー上のいろいろな情報にアクセスして、ファイルを操作しています。そのため、そこで不具合が起きると、HTMLの生成がうまくいかなくなったり、データが消えてしまったり、はたまた、悪意あるコードを読者に送ってしまうこともあります。Word Pressのセキュリティを突いた攻撃は結構多いみたいです。
</p><p>
セキュリティをしっかりするのは骨が折れます。専門知識も必要です。そんなわけで、サーバーの中で動的にデータを操作したり、ページを作成したりするようなPHPやSQL、そしてそのような言語を用いたWord Pressは使い始めるのにハードルが高いなと感じました。セキュリティの問題があるとすると、「まず始めてみよう！」ということが気軽にできないですからね。
</p>

<h4>選択肢は「静的」サイト</h4>
<p>
動的サイトがダメとなれば、選択肢は「静的」サイトになります。静的サイトでは、サーバー内でHTMLファイルを作ったり変更したりすることはしません。そのため、あらかじめ完成されたHTMLファイルを記事・ページごとに作ってサーバーに置いておかねばなりません。
</p><p>
いちいちHTMLファイルを作るのはこれはこれで大変です。記事ごとにHTMLファイルが必要ですが、それぞれの記事は統一感も必要です。ある程度、中身を合わせなくてはならないのですが、途中で変更が生じたりするとすべての記事に変更を加えなければならなくなります。いちいちHTMLを編集していくのは絶対に避けたい。
</p><p>
静的サイトでブログ記事を効率的に生成する方法があります。それは、ローカル環境で、Word Pressのようにデータベースやそれに類するものから、必要なHTMLを生成して、それをサーバーにアップロードするという方法です。この方法では、記事の追加や変更を行うたびに、HTMLファイルを作って上げ直せばなりません。また、コメント機能などを設置するのが難しくなります。しかしながら、上記のセキュリティメンテナンスを行うコストに比べたら、個人的にはデメリットとしては比較的小さいかなと思っております。何より、失敗しても実害が小さく抑えられるのが良いですね。
</p><p>
というわけで、戦略としては、まず、自分のパソコンで、記事のもとになるデータを作成する。それをHTMLファイルに変換して、サーバーにアップロードする、という流れを作ればいいというわけです。
</p>

<h3 id='ghpages'>サーバー代わりのGitHub Pages </h3>

<p>
GitHub Pagesというのは、GitHubのサービスのひとつです。
</p><p class='ref'><a href='https://pages.github.com/' target='_blank'>
GitHub Pages | Websites for you and your projects, hosted directly from your GitHub repository. Just edit, push, and your changes are live.</a>
</p><p>
GitHubは、かの有名な「設計図共有サイト」です（ネタ的には古いですかね）。
</p><p class='ref'>
参考　<a href='http://www.itmedia.co.jp/news/articles/1806/05/news069.html' target='_blank'>GitHubは「設計図共有サイト」？　日経記事の見出しが話題に　その後修正</a>
</p><p>
GitHubは、簡単に言うと、プログラムのコードを共有できるサイトです。しかも、プログラムの変更履歴も記録できるという優れもの。基本的には、プログラムファイルをこのサービスで公開し、いろんな人が公開されたプログラムに修正を加えていって、より良いプログラムを作っていく、といった使い方が多いのかなと思います。もちろん、プログラムを頒布する目的でも利用されています。
</p><p>
さて、このGitHubですが、アップしているプログラムをWebページとして公開することができます。これが、GitHub Pagesというサービスです。HTMLやCSS、Javascriptと言った静的なファイルをアップして、GitHub Pagesの機能を設定するだけで、Webページとして公開することができるのです。しかも無料です！
</p><p>
注意点として、GitHub PagesでWebページとして公開できるのは静的なページだけです。PHPやSQLなどを用いた動的なサイトは公開できません。もちろんWord Pressも使えません。しかし、私の戦略では、ローカルのパソコンでHTMLをすべて作成してしまいますから問題ありません。無料で使えますし、操作も簡単なので、とりあえず始めてみたいという自分にはピッタリなものでした。（もちろん、GitHub Pagesがベストではないと思いますが、悪い方法でもないと思っています。これは、他のサーバーを利用したことがないので何とも言えません。）
</p><p>
そもそもGitHub PagesはGitHubの１機能なので、GitHubによるデータの保管・変更履歴の管理という恩恵も受けられます。
</p>

<h3 id='rprog'>問題は、データ管理とHTML生成 </h3>
<h4> どこまで記事ごとに作るか？</h4>
<p>
頭を悩ませるのはここからです。データ管理と、HTMLをどのように作成するか、具体的に考えなくてはなりません。
</p><p>
HTMLのうち、本文は素直に最初からHTMLで書くことにしました。ブログ用のソフトウェアなどでは、記事の登録・編集画面などを用意して、簡単に記事作成が行えるようにするのでしょうが、私にそんな能力はありません。
</p><p>
しかし、HTMLの&lt;head&gt;部分や&lt;body&gt;の上部・下部（タイトルや免責事項など）は、一括管理したいと考えました。これは、すべての記事で同じにするべき部分だからです。そのため、記事ごとに異なる部分は個別で書いて、その個別部分と共通の部分をプログラムでくっつけることにしました。
</p><p>
記事ごとに異なる部分は、まず本文です。本文については、記事ごとにHTMLを直で書くことにしました。わたしの力では、Word等に書いた文章をHTMLに変換するのは至難の業なので、妥協しました。
</p><p>
ブログ業界では、Markdown記法やら、はてな記法やら、HTMLを書くよりもずっと効率的に記事本文を作成できる方法もあるようです。追々、勉強していけたらなとぼんやり考えています。
</p><p>
まぁ、これらを解釈できる無料の静的ブログ生成ソフトがいっぱいあるのだからそれを使えばいい話なんですけどね……。
</p><p>
本文以外に記事ごとに必要な要素はどうでしょうか？&lt;head&gt;部分にはタイトルやページの説明を入れることもあります。必要なライブラリやプラグインも記事ごとに異なるものを入れたいかもしれません。また、記事が増えてくると、記事の集計やカテゴリごとの整理が必要になるかもしれません。このとき、記事ごとのカテゴリやキーワードなどが取り出しやすいように独立に設計しておくと後々便利そうです。
</p>

<h4> 記事ごとのデータをどう管理するか？</h4>
<p>
検討の結果、以下の要素を記事ごとに作成することにしました。すべて文字列として管理します。
</p><p>
<ul>
<li>記事タイトル<br>
記事のタイトルで、タブなどにも表示させたいです。1つだけ設定。</li>
<li>キーワード<br>
記事に関連する単語。カテゴリよりも細かい分類を書いています。詳細な検索やソート、カテゴリ変更時の分類を楽にしたいという意図があります。複数個設定。</li>
<li>タグ<br>
特に使う予定はないですが、予備で。複数個設定。</li>
<li>カテゴリ<br>
記事を大きく分類するためのものです。1つだけ設定。</li>
<li>要約<br>
記事の内容を1行で説明します。記事一覧などで使えればと思っています。1つだけ設定。</li>
<li>ライブラリなど<br>
その記事だけに必要なCSSやJSなどを指定するためのものです。HTMLで書いておきます。複数個設定。</li>
<li>本文<br>
記事本体です。HTMLで書きます。1つだけ設定。</li>
<li>更新履歴<br>
公開日や、大きな修正をした際の日時を記録します。複数個設定。</li>
</ul>
</p>

<h4> 記事データのファイル形式</h4>
<p>
さて、書くべき要素は決まりましたが、どのような形式で保管すればよいのでしょうか？
</p><p>
重視するのは、「機械判読のしやすさ」です。ExcelやWordだと、人が管理するには良いのですが、機械（プログラム）で読むのは大変になります。
</p><p>
個人的に、機械判読がしやすいと言えるのはCSVくらいからと思っています。コンマで値が区切られたものですね。ただ、今回の場合、本文のコンマとまじりそうな感じがしたのでやめました。
</p><p>
というわけで、今回は、JSONという形式で記述していくことにしました。文章を機械判読させるとなるとXMLという形式も選択肢に上がりますが、JSONの方が構造が簡単そうだったのがその理由です。ま、とりあえず、機械判読できるいずれかの方式で書いておけば、今後、その他の形式へ変換するのも何とかなると思っています。
</p><p>
今回決めた記事ごとに作成する要素は、JSON形式では以下のように記述されます。
</p><p>
<div class='codearea'><pre><code>
{							<br>
    “title”:“記事タイトル（ひとつだけ）”, 		<br>
    “keyword”:[“キーワード1”,“キーワード2”, …], 	<br>
    “tag”:[“タグ1”, “タグ2”, …],			<br>
    “category”:“カテゴリ（ひとつだけ）”, 		<br>
    “summary”:“要約（ひとつだけ）“, 			<br>
    “library”:[“ライブラリ1”, “ライブラリ2”, …], 	<br>
    “article”:“本文（ひとつだけ）”, 			<br>
    “history”:[“更新履歴1”, “更新履歴2”, …]	<br>
}
</code></pre></div>
</p><p>
ちなみに、要素はダブルクォテーション（“”）で囲まれるのですが、本文のHTMLもダブルクォテーションで囲まれることになります。本文中にダブルクォテーションが入っているとエラーのもとになるため、本文中のHTMLは全てシングルクォテーション（‘’）を用いています。その影響で、上記JSONの記述例では、ダブルクォテーションは全角で表示しています……。
</p>

<h4> 記事の元データをHTMLに変換する</h4>
<p>
記事ごとに作ったJSONファイルから、公開用のHTMLファイルを作成するための変換方法を考えなければなりません。これは、プログラムを用いてくっつけることにしました。いわゆる「文字列操作」を行うわけです。
</p><p>
プログラム作成には、「R」という言語を使います。主に統計学で利用される言語ですが、一応、一般的な言語と同じようなことはできます。アプリ作成や速度が必要な作業には向いていませんが……。
</p><p class='ref'><a href='https://www.r-project.org/' target='_blank'>
The R Project for Statistical Computing</a>
</p><p>
なぜ、この言語にしたかといえば、「自分が使えるから」、これだけです。もっと適する言語はあるはずですが、自分が使えないのでは意味がありません。今回のプログラムで必要なことは、
<ol>
<li>データを読み込む。</li>
<li>共通パーツをくっつける。</li>
<li>HTMLファイルとして出力する。</li>
</ol>
これだけです。あまり高度なことは必要ないし、記事数もそんなに多くならないだろうし、とりあえずRだけでも十分です。困ったら、そのときに考えればいいのです。
</p><p>
JSONの読み込みには、“RJSONIO”というライブラリを利用しました。最初は“rjson”というライブラリを用いていたのですが、エラーが出てうまく読み込めなくなったので、ライブラリを変更しました。これで、今のところ読込みに問題は出ていません。
</p><p>
こちらのページが役立ちました。
</p><p class='ref'>
<a href ='https://stackoverflow.com/questions/32789253/unexpected-character-json-error-in-r' target='_blank'>Unexpected character json error in r </a><br>
―stack overview
</p><p>
プログラム自体の名前は、JSONをHTMLに変換する（Convert JSON to HTML）ということで、json2html.Rと名付けました。プログラム自体は、<a href='https://github.com/mghs15/webpage/blob/master/data/json2html.R' target='_blank'>こちら</a>で参照できます。
</p><p>
このプログラムには各ページに共通するHTMLパーツがすべて入っています。ページ全体のスタイル等を変える際は、このRプログラムを変更して、その後、記事をすべて出力し直すわけです。実際に、パンくずリストの追加や、Google analyticsの導入において、効果を発揮しています。
</p><p>
今後、記事が増えたときに、記事すべて生成し直すのに、どのくらい重くなるかが興味深いところです。
</p>

<h3 id='structd'>ディレクトリ構造について</h3>
<p>
ディレクトリについては、なるべくシンプルにしました。ルートディレクトリについては、トップページ（index.html）のほかに、各カテゴリの記事一覧ページctg1.html、ctg2.html…が配置されています。他に、ページ全体で共通して利用するCSSやJavascritpt、画像などを配置するディレクトリをルートディレクトリに配置する予定です。
</p><p>
記事はルートディレクトリ直下のarticleディレクトリの中にまとめられています。記事は、作成順にa1.html、a2.html、…と名前を付けています。HTMLファイル以外に、articleディレクトリには記事と同じ名前のディレクトリが存在します。このディレクトリには、その記事用の画像や補助的なHTMLを配置します。
</p><p>
記事の管理方法ですが、他の方のブログを見ていると、公開した日付ごとにディレクトリに分けたり、カテゴリごとに分けたりすることも多そうです。しかし、私の場合、カテゴリ分けを今後変更する可能性があること、公開月ごとの管理等をするつもりがなかったため、全ての記事を同一のディレクトリで管理することにしました。
</p><p>
一方で、ファイル名の衝突を防ぐために、機械的なファイル名となってしまいました。これはブラウザでの検索上、あまりよろしくないことのようですが、今回は妥協します。
</p><p>
リンク関係ですが、トップページ（index.html）からは今のところカテゴリごとの記事一覧ページ（ctg*.html）にリンクが張られています。カテゴリごとの記事一覧ページからは、それぞれの記事（a*.html）にリンクが張られています。どの記事も2クリックで開けます。しかし、実際のところ、記事検索機能などはないですから、記事が多くなれば、すんなり探すのは難しいと思います。
</p>


<h3 id='end'>今後の課題</h3>
<h4>説明不足な点</h4>
<p>
今回の記事では、私が、静的サイトを選んだこと、公開サーバーとしてGitHub Pagesを選らんだこと、各記事の管理方法について概説しました。ただ、Rプログラムの詳細や、サイトのデザイン、GitHubへのアップロード方法などについては述べておりません。追々、これらの内容も記事にまとめられたらいいなと思いますが、優先順位は高くないかと思います。
</p>

<h4>システムの改良について</h4>
<p>
今のところ、1記事を1つのHTMLにして、公開するところまで構築しました。今後は、記事データのJSONファイルを使ってカテゴリごとの記事一覧ページの自動生成や、トップページ（index.html）に新着情報を表示するなどのプログラムを作って自動化を進めたいです。今のところ、カテゴリごとの記事一覧は、記事を作るたびに手動で加えていっています。
</p><p>
また、今はまだ記事案がなかなか出ないし、文章作成能力もないしで、そんなに気にはなっていないですが、やっぱり１からHTMLで文章を作っていくのは結構つらい。
</p><p>
以下のR用パッケージを利用すると、Markdown記法を使って、Rからの出力を織り交ぜた文章をHTMLで出力できるようです。CSSの書き方や、すでに作ってしまった記事なんかをいろいろ変えねばならないですが、使いこなせたら、効率的になると思いますので、今後の目標ですね。HP作成以外にも生かせそうですしね。
</p><p class='ref'><a href='https://rmarkdown.rstudio.com/' target='_blank'>
R Markdown</a>
</p><p>
というわけで、今後も、いろいろ工夫しながら、ちまちましょーもない記事を上げていけたらいいなと思っています。
</p>
    </div> <div class='page_top'><a href='#top'>▲Page TOP</a></div>
<div id ='attention' class='attention'><p>
注意事項<br>本Webサイトで提供する情報の利用は自己責任でお願いいたします。また、画像や文章の著作権は放棄しておりません（HTMLやRのコードはご自由に利用ください）。
このHPで述べる内容は、私の所属するいかなる組織の見解をも代表するものではありません。<br>このページでは、Google Analyticsを用いたアクセス解析（Cookieの利用等）を行っております。
</p></div><div class='history'><p> <p> 2019年1月1日公開 </p></p></div></body></html>
